<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Safari has an &#39;Export to PDF...&#39; item in the &#39;File&#39; menu which, if you use it a lot, is something worth automating. Thanks to this thread on MacScripter this is easy to do using AppleScript....">
        <meta name="keywords" content="">
        <link rel="icon" href="http://0x7df.github.io/favicon.ico">

        <title>Scripting Safari's Export to PDF function on a Mac - 0x7df</title>

        <!-- Stylesheets -->
        <link href="http://0x7df.github.io/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="http://0x7df.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="0x7df Full Atom Feed" />
        <link href="http://0x7df.github.io/feeds/misc.atom.xml" type="application/atom+xml" rel="alternate" title="0x7df Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="http://0x7df.github.io/"><img class="mr20" src="http://0x7df.github.io/images/0x7df_60x60.png" alt="logo">0x7df</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="http://0x7df.github.io/">Blog Home</a>
                                <a href="http://0x7df.io">Site Home</a>
                                <a href="http://0x7df.github.io/categories.html">Categories</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Scripting Safari's Export to PDF function on a Mac</h1>
                      <p class="header-date">By <a href="http://0x7df.github.io/author/0x7df.html">0x7df</a>, Sun 14 May 2017, modified Sun 14 May 2017, in category <a href="http://0x7df.github.io/category/misc.html">Misc</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>Safari has an 'Export to PDF...' item in the 'File' menu which, if you use it a
lot, is something worth automating.</p>
<p>Thanks to <a href="http://macscripter.net/viewtopic.php?id=41654">this thread</a> on
<a href="http://macscripter.net">MacScripter</a> this is easy to do using AppleScript.</p>
<h1>Create script</h1>
<p>First create the AppleScript script using the native Script Editor app.</p>
<ol>
<li>Open 'Launchpad' and begin typing 'script editor' into the search bar at
   the top to find this app.
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_launchpad.png"></li>
<li>
<p>Paste the following script:</p>
<div class="highlight"><pre><span></span>set SaveFolderPath to &quot;~/Documents/Test_PDF_Save_Folder/&quot;
tell application &quot;Safari&quot; to activate
tell application &quot;System Events&quot;
    tell process &quot;Safari&quot;
        click menu item &quot;Show Reader&quot; of menu &quot;View&quot; of menu bar 1
        click menu item &quot;Export as PDFâ€¦&quot; of menu &quot;File&quot; of menu bar 1
        repeat until exists sheet 1 of window 1
            delay 0.02
        end repeat
        keystroke &quot;g&quot; using {command down, shift down}
        repeat until exists sheet 1 of sheet 1 of window 1
            delay 0.02
        end repeat
        tell sheet 1 of sheet 1 of window 1
            set value of text field 1 to SaveFolderPath
            click button &quot;Go&quot;
        end tell
        click button &quot;save&quot; of sheet 1 of window 1
        click menu item &quot;Close Tab&quot; of menu &quot;File&quot; of menu bar 1
    end tell
end tell
</pre></div>


<p>into the Script Editor:
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_scripteditor.png">
   This is slightly different from the script at
   <a href="http://macscripter.net/viewtopic.php?id=41654">this thread</a>, in that it
   hard-wires a save folder instead of bringing up a dialogue box each time,
   and also that it puts the web page into reader view before exporting it.</p>
</li>
<li>
<p>Save the script somewhere, e.g.
    <code>~/Documents/Test_PDF_Save_Folder/safari_export_PDF.scpt</code></p>
</li>
</ol>
<p>This script can be run from the command line:</p>
<div class="highlight"><pre><span></span>osascript ~/Documents/Test_PDF_Save_Folder/safari_export_PDF.scpt
</pre></div>


<p>to export the currently active tab in Safari to a PDF in the specified
location.</p>
<h1>Create a keyboard shortcut</h1>
<p>For extra convenience a keyboard shortcut can be created to run the script.
This uses the 'Automator' app.</p>
<ol>
<li>Start typing 'automator' into the Launchpad search bar:
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_launchpad2.png"></li>
<li>Select 'Service'
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_automator.png"></li>
<li>In the automator app, drag the 'Run shell script' item over to the main
   panel</li>
<li>Add the <code>osascript ~/Documents/Test_PDF_Save_Folder/safari_export_PDF.scpt</code>
   command
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_automator2.png"></li>
<li>Save the workflow. The default save location is <code>~/Library/Services</code>.</li>
<li>In the 'System Preferences', go to 'Keyboard', 'Shortcuts', select
   'Services', and select the recently-saved workflow
   <img alt="Photo" src="http://0x7df.github.io/images/screenshot_keyboard_shortcut.png"></li>
<li>Choose a shortcut: in this example Shift-Command-E has been chosen</li>
</ol>
<h1>Summary</h1>
<p>Now, after reading an article in Safari, pressing Shift-Command-E saves a PDF
version of the article in the folder specified, and closes the tab.</p>


        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="http://0x7df.github.io/archives.html">Archives</a></li>
                            <li><a href="http://0x7df.github.io/tags.html">Tags</a></li>
                            <li><a href="http://0x7df.github.io/authors.html">Authors</a></li>
                            <li><a href="http://0x7df.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://twitter.com/@0x7df" target="_blank">Twitter</a></li>
                            <li><a href="https://github.com/0x7df" target="_blank">GitHub</a></li>
                            <li><a href="https://www.facebook.com/0x7df" target="_blank">Facebook</a></li>
                            <li><a href="https://stackoverflow.com/users/4802778" target="_blank">StackOverflow</a></li>
                            <li><a href="http://www.freecodecamp.com/0x7df" target="_blank">FreeCodeCamp</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
                            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
                            <li><a href="https://github.com/barrysteyn/pelican_plugin-render_math" target="_blank">Maths plugin</a></li>
                            <li><a href="https://github.com/molivier/nest" target="_blank">Nest theme</a></li>
                            <li><a href="" target="_blank"></a></li>
                            <li><a href="" target="_blank"></a></li>
                            <li><a href="" target="_blank"></a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; 0x7df 2015</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>