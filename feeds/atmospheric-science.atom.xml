<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>0x7df - Atmospheric Science</title><link href="http://0x7df.github.io/" rel="alternate"></link><link href="http://0x7df.github.io/feeds/atmospheric-science.atom.xml" rel="self"></link><id>http://0x7df.github.io/</id><updated>2017-02-17T15:29:00+00:00</updated><entry><title>The shallow water equations</title><link href="http://0x7df.github.io/the-shallow-water-equations.html" rel="alternate"></link><published>2017-02-17T15:29:00+00:00</published><updated>2017-02-17T15:29:00+00:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2017-02-17:/the-shallow-water-equations.html</id><summary type="html"></summary><content type="html">&lt;p&gt;The governing equations in geophysical fluid dynamics can be simplified somewhat if the
horizontal length and velocity scales are much larger than the vertical length and
velocity scales, respectively.&lt;/p&gt;
&lt;p&gt;They are commonly used to describe both the ocean and atmosphere, as well as estuaries,
rivers and channels.&lt;/p&gt;
&lt;p&gt;A set of assumptions are made:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The fluid is incompressible.&lt;/li&gt;
&lt;li&gt;Vertical acceleration is small compared with horizontal accelerations, and
   &lt;a href="http://0x7df.github.io/hydrostatic-balance-in-the-atmosphere.html"&gt;hydrostatic balance&lt;/a&gt;
   can be assumed.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Making these assumptions results in the 3D shallow water equations (&lt;a href="https://www.utwente.nl/ewi/sacs/teaching/Thesis/aukje-de-boer-comparison-of-two-numerical-schemes-for-solving-the-1d-shallow-water-equations.pdf"&gt;de Boer (2003)&lt;/a&gt;.
However it is much more common to make the additional assumption that:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The horizontal velocity is constant with height/depth (there is no vertical shear).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Given these assumptions, the 2D shallow water equations are then derived by integrating
over height to remove the vertical velocity, and therefore the vertical dimension
altogether. (Note that this is not the same as assuming the vertical velocity is zero,
which is not necessarily the case. If the bathymetry accounted for, the vertical velocity must be
non-zero where the floor changes depth. The vertical velocity can be recovered from
solutions of the shallow water equations via the continuity equation.)&lt;/p&gt;
&lt;p&gt;In the following equations we will ignore viscosity (i.e we will work from the Euler
fluid equations not the Navier-Stokes equations, although in some disciplines the
fluid viscosity is important and can be included in the shallow water equtions). This
renders the non-linear PDEs hyperbolic rather than parabolic. We shall also ignore
diffusion.&lt;/p&gt;
&lt;h2&gt;Three-dimensional shallow water equtions&lt;/h2&gt;
&lt;p&gt;In general in 3D the conservation of momentum is expressed by:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u}\cdot\nabla\mathbf{u}
    + f\mathbf{k}\times\mathbf{v} = -\frac{1}{\rho}\nabla p - g\mathbf{\hat k} $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(f\)&lt;/span&gt; is the Coriolis parameter, &lt;span class="math"&gt;\(\mathbf{\hat k}\)&lt;/span&gt; is a unit vector pointing away
from the centre of the planet. Also, &lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt; is the three-dimensional velocity
vector and &lt;span class="math"&gt;\(\mathbf{v}\)&lt;/span&gt; is the two-dimensional horizontal velocity vector, and we
have assumed the Coriolis force acts solely in the horizontal, since its vertical
component is small compared with the gravitational and pressure gradient forces.&lt;/p&gt;
&lt;p&gt;Alternatively:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial u}{\partial t} + \frac{\partial uu}{\partial x}
    + \frac{\partial uv}{\partial y} + \frac{\partial uw}{\partial z}
    = -\frac{1}{\rho}\frac{\partial p}{\partial x}  + fv $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial v}{\partial t} + \frac{\partial vu}{\partial x}
    + \frac{\partial vv}{\partial y} + \frac{\partial vw}{\partial z}
    = -\frac{1}{\rho}\frac{\partial p}{\partial y} - fu $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial w}{\partial t} + \frac{\partial wu}{\partial x}
    + \frac{\partial wv}{\partial y} + \frac{\partial ww}{\partial z}
    = -\frac{1}{\rho}\frac{\partial p}{\partial z} - g $$&lt;/div&gt;
&lt;p&gt;The conservation of mass under the assumption of incompressibility is:&lt;/p&gt;
&lt;div class="math"&gt;$$ \nabla\cdot\mathbf{u} = 0 $$&lt;/div&gt;
&lt;p&gt;or:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}
   + \frac{\partial w}{\partial z} = 0 $$&lt;/div&gt;
&lt;p&gt;The condition of hydrostatic balance, which is the first key assumption of the
shallow water equations, is given by:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation} \label{HydrostaticBalance} \frac{1}{\rho}\frac{\partial p}{\partial z} = -g \end{equation}&lt;/div&gt;
&lt;p&gt;This is derived from the momentum equation describing &lt;span class="math"&gt;\(w\)&lt;/span&gt; by assuming that the left-
hand side is zero:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{Dw}{Dt} = \frac{\partial w}{\partial t} + \frac{\partial wu}{\partial x}
    + \frac{\partial wv}{\partial y} + \frac{\partial ww}{\partial z}
    = 0 $$&lt;/div&gt;
&lt;p&gt;The hydrostatic balance equation can be immediately integrated from some arbitrary depth
&lt;span class="math"&gt;\(z\)&lt;/span&gt; up to the free surface, to give:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = p_0 + \rho g\left(h - z\right) $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(p_0\)&lt;/span&gt; is the fixed pressure at the free surface (e.g. zero for the atmosphere, or
atmospheric pressure for the ocean), and &lt;span class="math"&gt;\(h\)&lt;/span&gt; is the elevation of the free
surface above &lt;span class="math"&gt;\(z = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Then:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial p}{\partial x} = \rho g\frac{\partial h}{\partial x} $$&lt;/div&gt;
&lt;p&gt;and similarly for &lt;span class="math"&gt;\(\partial p/\partial y\)&lt;/span&gt;. I.e.:&lt;/p&gt;
&lt;div class="math"&gt;$$ -\frac{1}{\rho}\nabla_h p = -g \nabla_h h $$&lt;/div&gt;
&lt;p&gt;The implication is that the horizontal pressure gradient force is a result only of
horizontal variatons in the free surface height.&lt;/p&gt;
&lt;p&gt;The remaining two components of the momentum equation are consequently:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation} \label{3Du} \frac{\partial u}{\partial t} + \frac{\partial uu}{\partial x}
    + \frac{\partial uv}{\partial y} + \frac{\partial uw}{\partial z}
    = -g\frac{\partial h}{\partial x} + fv \end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation} \label{3Dv} \frac{\partial v}{\partial t} + \frac{\partial vu}{\partial x}
    + \frac{\partial vv}{\partial y} + \frac{\partial vw}{\partial z}
    = -g\frac{\partial h}{\partial y} - fu \end{equation}&lt;/div&gt;
&lt;p&gt;Equations &lt;span class="math"&gt;\(\ref{3Du}\)&lt;/span&gt;, &lt;span class="math"&gt;\(\ref{3Dv}\)&lt;/span&gt; and &lt;span class="math"&gt;\(\ref{3Dh}\)&lt;/span&gt; are the 3D shallow water equations.&lt;/p&gt;
&lt;h2&gt;Two-dimensional shallow water equations&lt;/h2&gt;
&lt;p&gt;To obtain the 2D shallow water equations we integrate the 3D equations over &lt;span class="math"&gt;\(z\)&lt;/span&gt;, to
obtain depth- (or height-) averaged forms of the equations. The Liebniz integral
rule is required since &lt;span class="math"&gt;\(h\)&lt;/span&gt;, which is one of the limits of the integration over &lt;span class="math"&gt;\(z\)&lt;/span&gt;,
depends on &lt;span class="math"&gt;\(x\)&lt;/span&gt;, &lt;span class="math"&gt;\(y\)&lt;/span&gt; and &lt;span class="math"&gt;\(t\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;In 2D, the shallow water equations (neglecting diffusion, viscosity and friction) are:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial h}{\partial t} + \frac{\partial hu}{\partial x} + \frac{\partial hv}
    {\partial y} = 0 $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial hu}{\partial t} + \frac{\partial hu^2}{\partial x}
    + \frac{\partial huv}{\partial y} = -g\frac{\partial h}{\partial x} + fhv $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial hv}{\partial t} + \frac{\partial huv}{\partial x}
    + \frac{\partial hv^2}{\partial y} = -g\frac{\partial h}{\partial y} -fhu $$&lt;/div&gt;
&lt;p&gt;The shallow water equations can be written more compactly thus:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial phi}{\partial t} + \mathbf{v}\cdot\nabla\phi + \phi\nabla\cdot\mathbf{v}
    = 0$$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial\mathbf{v}}{\partial t} + \mathbf{v}\cdot\nabla\mathbf{v}
    + \nabla\mathbf{\phi} + f\mathbf{\hat k}\times\mathbf{v} = 0 $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(\phi = gh\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The first equation is obtained by integrating the continuity equation:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}
   + \frac{\partial w}{\partial z} = 0 $$&lt;/div&gt;
&lt;p&gt;with respect to &lt;span class="math"&gt;\(z\)&lt;/span&gt; to give:&lt;/p&gt;
&lt;div class="math"&gt;$$ \left(\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}\right)h + w_h - w_0 = 0 $$&lt;/div&gt;
&lt;p&gt;The vertical velocity disappears at the lower boundary (&lt;span class="math"&gt;\(w_0 = 0\)&lt;/span&gt;) and the vertical
velocity at the free surface (at height &lt;span class="math"&gt;\(h\)&lt;/span&gt;) is given by:&lt;/p&gt;
&lt;div class="math"&gt;$$ w_h = \frac{Dh}{Dt} $$&lt;/div&gt;
&lt;p&gt;Thus:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{Dh}{Dt} = \frac{\partial h}{\partial t} 
    + \frac{\partial hu}{\partial x} + \frac{\partial hv}{\partial y} = w_h
    = \left(\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}\right)h $$&lt;/div&gt;
&lt;h1&gt;One-dimensional shallow water equations&lt;/h1&gt;
&lt;p&gt;In 1D, which is often used for river management and hydraulics, the equations are:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial u}{\partial t} = -u \frac{\partial u}{\partial x}
                                   -g \frac{\partial h}{\partial x} $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \frac{\partial h}{\partial t} = -u \frac{\partial h}{\partial x}
                                   -h \frac{\partial u}{\partial x} $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(h\)&lt;/span&gt; is the height of the free surface. Accelerations in the &lt;span class="math"&gt;\(y\)&lt;/span&gt; direction have
also been assumed negligible.&lt;/p&gt;
&lt;p&gt;In both equations the first term on the right
represents advection and the second term on the right represents &lt;a href="http://0x7df.github.io/adjustment-of-meteorological-fields-in-nwp.html"&gt;adjustment&lt;/a&gt;. (More
complex variants are used in river modelling and hydraulics that account for, for example,
the cross-sectional area of the channel. These are often referred to as the
&lt;a href="https://en.wikipedia.org/wiki/Shallow_water_equations#One-dimensional_Saint-Venant_equations"&gt;Saint Venant&lt;/a&gt;
equations, having originally been derived by Adhemar Jean Claude Barre de Saint-Venant,
in 1871.)&lt;/p&gt;
&lt;p&gt;In hydraulics studies Coriolis force is ignored but in geophysics applications it is
included, making the shallow water equations a useful simplistic framework in which to
study rotational flow under gravity.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Adjustment of meteorological fields in NWP</title><link href="http://0x7df.github.io/adjustment-of-meteorological-fields-in-nwp.html" rel="alternate"></link><published>2017-02-16T00:32:00+00:00</published><updated>2017-02-16T00:32:00+00:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2017-02-16:/adjustment-of-meteorological-fields-in-nwp.html</id><summary type="html"></summary><content type="html">&lt;p&gt;According to &lt;a href="http://www.ecmwf.int/sites/default/files/elibrary/2002/16948-numerical-methods.pdf"&gt;Riddaway and Hortal&lt;/a&gt;, the set of coupled non-linear partial differential equations solved in &lt;a href="https://en.wikipedia.org/wiki/Numerical_weather_prediction"&gt;numerical weather prediction&lt;/a&gt; (NWP) describe three important dynamical processses:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Advection&lt;/li&gt;
&lt;li&gt;Diffusion&lt;/li&gt;
&lt;li&gt;Adjustment&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The first two are familiar to the non-meteorologist more used to working with the general equations of fluid motion. The third, &lt;em&gt;adustment&lt;/em&gt;, is less so.&lt;/p&gt;
&lt;p&gt;They describe adjustment as 'how the mass and wind fields adjust to one another'.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://books.google.com/books?isbn=0323157467"&gt;Marchuk (1974)&lt;/a&gt; also identifies three basic factors defining the evolution of meteorological fields (p.118):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The transport of meteorological substances along particle trajectories&lt;/li&gt;
&lt;li&gt;Turbulent exchange&lt;/li&gt;
&lt;li&gt;The adjustment of the fields&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;which are analogous.&lt;/p&gt;
&lt;p&gt;Marchuk describes the distinction thus:&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;One can imagine the following simplified pattern of evolution of the meteorological fields. Let us consider an elementary time interval &lt;span class="math"&gt;\(\Delta t\)&lt;/span&gt;. During this time interval, the meteorological [fields], fixed at the initial instant of the time interval, will move along the trajectories with a velocity &lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;, so that the initial particle position vector &lt;span class="math"&gt;\(\mathbf{r}_0\)&lt;/span&gt; will become &lt;span class="math"&gt;\(\mathbf{r} = \mathbf{r}_0 + \mathbf{u}\Delta t\)&lt;/span&gt;. Naturally, this will disrupt the basic adjustment... The adjustment of the fields takes place after their displacement along the trajectories, during the second step. The wave processes, ... gravity and sound waves, are considered as the mechanism of field adjustment in the case of the simplest models of atmospheric motions. The wave processes are instrumental in distributing the discrepancies in adjustment over the [meteorological fields] and in correcting these disrepancies in accordance with the laws of dynamics... Of course, this is a simplification of the complex nature of the dynamics of atmospheric processes; however, such a model reflects, in general outline, the continuous operation of the basic factors, and does it better, the smaller the &lt;span class="math"&gt;\(\Delta t\)&lt;/span&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;Similarly, in &lt;a href="https://www.amazon.co.uk/d/Books/Numerical-Techniques-Atmospheric-Lecture-Computational-Science-Engineering/3642116396"&gt;Lauritzen &lt;em&gt;et al.&lt;/em&gt; (2010&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;On large scales, the dynamics of the atmosphere is approximately &lt;em&gt;balanced&lt;/em&gt;,
and it is important for numerical solutions to be approximately balanced in
the same sense... Fast &lt;em&gt;acoustic&lt;/em&gt; and &lt;em&gt;inertio-gravity waves&lt;/em&gt; [are]
responsible for the &lt;em&gt;adjustment&lt;/em&gt; towards balance.&lt;/p&gt;
&lt;p&gt;... The fast acoustic and inertio-gravity waves are observed to be
energetically weak... The weakness of these fast waves corresponds to 
certain kinds of approximate balance between other terms in the governing
equations... The atmosphere is continually being perturbed away from balance
by a variety of mechanisms, including flow over orography, convective
instability, and the nonlinear nature of the balanced dynamics. The
mechanism by which the atmosphere adjusts back towards balance involves the
radiation and ultimate dissipation of the fast acoustic and inertio-gravity
waves.&lt;/p&gt;
&lt;p&gt;The physical mechanism for acoustic waves involves the interaction of
compressibility and flow divergence: convergence of fluid locally leads to
an increase in density and hence pressure; the resulting pressure gradient
then drives fluid acceleration leading to new convergence displaced from the
original convergence.&lt;/p&gt;
&lt;p&gt;There are two basic physical mechanisms underlying inertio-gravity waves.
At the inertial end of the spectrum, i.e. shallow waves, an air parcel
displaced from its equilibrium position experiences a restoring force
provided by the Coriolis effect. At the gravity wave end of the spectrum,
i.e. deep waves, an air parcel displaced from its equilibrium position
has a density different from that of the reference profile at that height
and so experiences a restoring force due to buoyancy, i.e. the imbalance
between the gravitational force on the parcel and the vertical pressure
gradient force. In intermediate parts of the spectrum both mechanisms
operate to some degree.&lt;/p&gt;
&lt;p&gt;Making the [vertical balance] approximation in the governing equations
corresponds to filtering internal acoustic waves from the governing 
equations. More precisely, it corresponds to taking the limit in which
the propagation speed of internal acoustic waves becomes infinite, so
that the adjustment to balance is instantaneous. In the unapproximated
equations all information propagates at a finite speed; these are 
&lt;em&gt;hyperbolic&lt;/em&gt; equations. The balance approximation introduces a certain
non-locality.&lt;/p&gt;
&lt;p&gt;Similar ideas apply in the case of [horizontal] balance. The atmosphere
adjusts towards... balance through the radiation and dissipation of
inertio-gravity waves. The balance approximation filters inertio-gravity
waves from the governing equations, or, rather, corresponds to the limit
in which inertio-gravity waves propagate infinitely fast so that the
adjustment process is instantaneous.&lt;/p&gt;
&lt;p&gt;Even if we are solving the unapproximated (i.e. hyperbolic) governing
equations, balance and the implied nonlocality are important. However
the solution of elliptic equations requires quite different numerical techniques
from the solution of hyperbolic equations. Model developers therefore
face an important choice between inherently local explicit time stepping
techniques and inherently nonlocal implicit time stepping techniques.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>500 hPa geopotential height anomaly correlation</title><link href="http://0x7df.github.io/500-hpa-geopotential-height-anomaly-correlation.html" rel="alternate"></link><published>2017-02-11T20:25:00+00:00</published><updated>2017-02-11T20:25:00+00:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2017-02-11:/500-hpa-geopotential-height-anomaly-correlation.html</id><summary type="html"></summary><content type="html">&lt;p&gt;The 500 hPa &lt;a href="http://0x7df.github.io/geopotential.html"&gt;geopotential&lt;/a&gt; height anomaly
correlation is a key indicator of the skill of numerical weather prediction.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.e-education.psu.edu/worldofweather/node/2031"&gt;Patterns of 500 hPa heights reveal short- and long-wave troughs and ridges.&lt;/a&gt; Surface low
pressure tends to develop (or strengthen) to the east of 500 hPa short-wave
troughs, while surface high pressure tends to form (or strengthen) to the
east of 500 hPa short-wave ridges. &lt;/p&gt;
&lt;p&gt;The correlation is between the &lt;em&gt;observed&lt;/em&gt; and &lt;em&gt;forecast&lt;/em&gt; 500 hPa geopotential
height anomaly. A higher value is better, indicating a forecast that was closer
to the observed situation.&lt;/p&gt;
&lt;p&gt;A correlation of 0.6 is considered to represent a useful forecast. For the
&lt;a href="https://www.ecmwf.int"&gt;ECMWF&lt;/a&gt; model, forecasts fell below 0.6 at about 5.5
days in 1980, whereas by 2010 they did not fall below 0.6 until about 8.5 days
- this represents an improvement in skill of one day per decade. The forecast
for which the value falls to 0.8 is approaching 6.5 days.&lt;/p&gt;</content><category term="meteorology"></category></entry><entry><title>Virtual Temperature</title><link href="http://0x7df.github.io/virtual-temperature.html" rel="alternate"></link><published>2015-08-31T22:02:00+01:00</published><updated>2015-08-31T22:02:00+01:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2015-08-31:/virtual-temperature.html</id><summary type="html">&lt;h2&gt;Equation of state for dry air&lt;/h2&gt;
&lt;p&gt;The ideal-gas equation of state is:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = \rho R T $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R\)&lt;/span&gt; is the individual gas constant for the
gas in question, and:&lt;/p&gt;
&lt;div class="math"&gt;$$ R = \frac{nR^*}{m} = \frac{R^*}{M} $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R^*\)&lt;/span&gt; is the universal gas constant (&lt;span class="math"&gt;\( 8.31~
\mathrm{J/mol.K}\)&lt;/span&gt;) and …&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Equation of state for dry air&lt;/h2&gt;
&lt;p&gt;The ideal-gas equation of state is:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = \rho R T $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R\)&lt;/span&gt; is the individual gas constant for the
gas in question, and:&lt;/p&gt;
&lt;div class="math"&gt;$$ R = \frac{nR^*}{m} = \frac{R^*}{M} $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R^*\)&lt;/span&gt; is the universal gas constant (&lt;span class="math"&gt;\( 8.31~
\mathrm{J/mol.K}\)&lt;/span&gt;) and &lt;span class="math"&gt;\( n, m\)&lt;/span&gt; are the number of moles and the
mass of the sample of gas, respectively; and &lt;span class="math"&gt;\( M = m/n\)&lt;/span&gt;
is the molecular mass of the gas.&lt;/p&gt;
&lt;p&gt;Dry air is typically assumed to be a perfect gas, with an individual gas
constant of &lt;span class="math"&gt;\( 287~\mathrm{J/kg.K}\)&lt;/span&gt;  or &lt;span class="math"&gt;\( 2.87 \times 10^6~\mathrm{cm^2/s^2.K}\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2&gt;Moist air and virtual temperature&lt;/h2&gt;
&lt;p&gt;Water vapour is also assumed to be a perfect gas, with an individual gas
constant of &lt;span class="math"&gt;\( 461.5~\mathrm{J/kg.K}\)&lt;/span&gt;. The ratio of &lt;span class="math"&gt;\( R / R_v\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \sigma = \frac{R}{R_v} = \frac{M_v}{M} = 0.622 $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R, M\)&lt;/span&gt; are the gas constant and molecular mass
of dry air, and &lt;span class="math"&gt;\( R_v, M_v\)&lt;/span&gt; of water vapour.&lt;/p&gt;
&lt;p&gt;Moist air is a mixture of dry air and water vapour. To determine the
individual gas constant of moist air, consisting of some mixture of dry
air and water vapour, we first write the equation of state for water
vapour:&lt;/p&gt;
&lt;div class="math"&gt;$$ e = \rho_v R_v T $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( e\)&lt;/span&gt; is the water vapour pressure and &lt;span class="math"&gt;\( \rho_v\)&lt;/span&gt; is the density of water
vapour. The pressure of the moist air is the sum of the partial pressures of
the dry air and the water vapour:&lt;/p&gt;
&lt;div class="math"&gt;$$ p_m = p + e = \rho R T + \rho_v R_v T $$&lt;/div&gt;
&lt;div class="math"&gt;$$ p_m = \rho R T + \rho_v \frac{R}{\sigma} T $$&lt;/div&gt;
&lt;div class="math"&gt;$$ p_m = RT\left(\rho + \frac{\rho_v}{\sigma}\right) $$&lt;/div&gt;
&lt;div class="math"&gt;$$ p_m = RT\frac{1}{V}\left(m + \frac{m_v}{\sigma}\right) $$&lt;/div&gt;
&lt;div class="math"&gt;$$ p_m = RT \frac{\rho_m}{m + m_v}\left(m +
\frac{m_v}{\sigma}\right) $$&lt;/div&gt;
&lt;p&gt;This allows us to introduce the &lt;em&gt;virtual temperature&lt;/em&gt;, which is the
fictitious temperature that dry air would have to have to achieve
the same (lower) density of the moist air, at the same pressure:&lt;/p&gt;
&lt;div class="math"&gt;$$ p_m = \rho_m RT_v $$&lt;/div&gt;
&lt;p&gt;From comparing the last two equations we can see that:&lt;/p&gt;
&lt;div class="math"&gt;$$ T_v = \left[m + \frac{m_v}{\sigma}\right]\frac{1}{m+m_v} T $$&lt;/div&gt;
&lt;div class="math"&gt;$$ T_v = \left[m + m_v + \frac{m_v}{\sigma} - m_v\right]
\frac{1}{m + m_v} T $$&lt;/div&gt;
&lt;div class="math"&gt;$$ T_v = \left[1 + \frac{m_v}{m +
m_v}\left(\frac{1}{\sigma} - 1\right)\right] T $$&lt;/div&gt;
&lt;div class="math"&gt;$$ T_v = \left[1 + \frac{m_v}{m + m_v}\frac{1 -
\sigma}{\sigma} \right] \frac{1}{m + m_v} T $$&lt;/div&gt;
&lt;p&gt;By definition, the mixing ratio &lt;span class="math"&gt;\( \mu = m_v/(m + m_v)\)&lt;/span&gt;
is the ratio of the mass of water vapour to the mass of
moist air:&lt;/p&gt;
&lt;div class="math"&gt;$$ T_v = \left[1 + \frac{1-\sigma}{\sigma} \mu \right] T $$&lt;/div&gt;
&lt;p&gt;The virtual temperature is always slightly higher, by at most a few
degrees, than the true temperature of the moist air.&lt;/p&gt;
&lt;h2&gt;Geopotential in terms of virtual temperature&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://0x7df.github.io/geopotential.html"&gt;Elsewhere&lt;/a&gt; we have seen that the geopotential is:&lt;/p&gt;
&lt;div class="math"&gt;$$ d\phi = -\frac{1}{\rho} dp $$&lt;/div&gt;
&lt;p&gt;Substituting in the equation of state for moist air, involving the
virtual temperature:&lt;/p&gt;
&lt;div class="math"&gt;$$ d\phi = -RT_v \frac{dp}{p} $$&lt;/div&gt;
&lt;p&gt;Integrating:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi = \phi_0 - R \int_{p_0}^p T_v d\ln p $$&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="atmospheric science"></category><category term="meteorology"></category><category term="physics"></category></entry><entry><title>Geopotential</title><link href="http://0x7df.github.io/geopotential.html" rel="alternate"></link><published>2015-08-30T16:58:00+01:00</published><updated>2015-08-30T16:58:00+01:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2015-08-30:/geopotential.html</id><summary type="html">&lt;p&gt;The &lt;em&gt;geopotential&lt;/em&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi = gz $$&lt;/div&gt;
&lt;p&gt;is the gravitational potential - i.e. the gravitational potential energy
per unit mass - at a location in the earth's atmosphere. It is often
used as a vertical coordinate instead of height above sea level,
&lt;span class="math"&gt;\( z\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The geopotential at height &lt;span class="math"&gt;\( z\)&lt;/span&gt; is the difference
between the gravitational …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The &lt;em&gt;geopotential&lt;/em&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi = gz $$&lt;/div&gt;
&lt;p&gt;is the gravitational potential - i.e. the gravitational potential energy
per unit mass - at a location in the earth's atmosphere. It is often
used as a vertical coordinate instead of height above sea level,
&lt;span class="math"&gt;\( z\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The geopotential at height &lt;span class="math"&gt;\( z\)&lt;/span&gt; is the difference
between the gravitational potential energy at some reference height,
&lt;span class="math"&gt;\( z_0\)&lt;/span&gt;, usually taken to be zero (sea level), and
that at &lt;span class="math"&gt;\( z\)&lt;/span&gt;. This difference is numerically equal
to the work done in raising the parcel from &lt;span class="math"&gt;\( z_0\)&lt;/span&gt;
to &lt;span class="math"&gt;\( z\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(z) = \int_{z_0}^z g(z') dz' $$&lt;/div&gt;
&lt;p&gt;The simplification to:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi = gz $$&lt;/div&gt;
&lt;p&gt;assumes that &lt;span class="math"&gt;\( g\)&lt;/span&gt; is constant with height. If the
variation is to be taken into account, a suitable profile for
&lt;span class="math"&gt;\( g(z)\)&lt;/span&gt; is:&lt;/p&gt;
&lt;div class="math"&gt;$$ g(z) = \frac{g_0}{\left[ 1 + \left(
z/E\right)\right]^2} $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( g_0\)&lt;/span&gt; is the value at sea level and
&lt;span class="math"&gt;\( E\)&lt;/span&gt; is the earth's mean radius. Substituting into
the definition of geopotential:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(z) = \int_{z_0}^z g(z') dz' $$&lt;/div&gt;
&lt;p&gt;gives:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(z) = \int_{z_0}^z \frac{g_0}{\left[ 1 + z' / E
\right]^2} dz' $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \phi(z) = g_0 E^2 \int_{z_0}^z \frac{1}{\left[ E+z'
\right]^2} dz' $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \phi(z) = g_0 \frac{z-z_0}{\left( 1+z/E \right) \left(
1+z_0/E \right)} $$&lt;/div&gt;
&lt;p&gt;or, if we take &lt;span class="math"&gt;\( z_0\)&lt;/span&gt; to be zero:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(z) = g_0 \frac{z}{1+z/E} $$&lt;/div&gt;
&lt;p&gt;The assumption that gravity is constant is equivalent to assuming that
&lt;span class="math"&gt;\( z \ll E\)&lt;/span&gt; so that &lt;span class="math"&gt;\( z/E \ll 1\)&lt;/span&gt;,
and therefore that the denominator on the right-hand
side of the above equation is unity.&lt;/p&gt;
&lt;p&gt;In terms of differentials:&lt;/p&gt;
&lt;div class="math"&gt;$$ d\phi = g dz $$&lt;/div&gt;
&lt;p&gt;and taking into consideration the hydrostatic equation:&lt;/p&gt;
&lt;div class="math"&gt;$$ dp = -\rho g dz $$&lt;/div&gt;
&lt;p&gt;we obtain:&lt;/p&gt;
&lt;div class="math"&gt;$$ d\phi = -\frac{dp}{\rho} = -\alpha dp $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( \alpha = 1 / \rho\)&lt;/span&gt; is the specific volume
(volume per unit mass).&lt;/p&gt;
&lt;p&gt;The geopotential is larger than the geometric height by a factor of
&lt;span class="math"&gt;\( g\)&lt;/span&gt; - e.g. the geopotential in &lt;span class="math"&gt;\( \mathrm{J/kg}\)&lt;/span&gt; is about 10
times the magnitude of the geometric altitude in metres. To make the
geopotential have numerical magnitude more nearly equal to the geometric
height, it is often expressed in units a factor of &lt;span class="math"&gt;\( g_0\)&lt;/span&gt;
smaller; these units are usually called &lt;em&gt;geopotential
metres&lt;/em&gt;, or &lt;em&gt;dynamic metres&lt;/em&gt;, or &lt;em&gt;geodynamic metres&lt;/em&gt;. That is, the
geopotential in these units, is:&lt;/p&gt;
&lt;div class="math"&gt;$$ \mathrm{gpm}(z) = \frac{\phi(z)}{g_0} $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \mathrm{gpm}(z) = \frac{\int_{z_0}^z g(z') dz'}{g_0} $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \mathrm{gpm}(z) = \frac{z}{1+z/E} $$&lt;/div&gt;
&lt;h2&gt;Rogers and Yau Problem 3.2b&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Show that the geopotential at pressure level &lt;span class="math"&gt;\( p\)&lt;/span&gt;
of an atmosphere in hydrostatic equilibium is given
by:&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$ \phi(p) = R\bar T\ln{\left(p_0/p\right)} $$&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( \phi(p_0) = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The differential expression for hydrostatic equilibrium is:&lt;/p&gt;
&lt;div class="math"&gt;$$ dp = -g\rho dz $$&lt;/div&gt;
&lt;p&gt;From the definition of geopotential:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(z) = g \int_{z_0}^z dz' $$&lt;/div&gt;
&lt;p&gt;we have:&lt;/p&gt;
&lt;div class="math"&gt;$$ d\phi = g dz $$&lt;/div&gt;
&lt;p&gt;Hence:&lt;/p&gt;
&lt;div class="math"&gt;$$ dp = -\rho d\phi $$&lt;/div&gt;
&lt;p&gt;Introducing the equation of state gives:&lt;/p&gt;
&lt;div class="math"&gt;$$ dp = \frac{p}{RT} d\phi $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \int \frac{dp}{p} = -\frac{1}{R} \int \frac{d\phi}{T} $$&lt;/div&gt;
&lt;p&gt;Performing the integration gives:&lt;/p&gt;
&lt;div class="math"&gt;$$ \ln(p) = -\frac{1}{R\bar T} \phi(p) + C $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( \bar T\)&lt;/span&gt; is the average temperature
through the layer from &lt;span class="math"&gt;\( p_0\)&lt;/span&gt; to &lt;span class="math"&gt;\( p\)&lt;/span&gt;.
Since &lt;span class="math"&gt;\( \phi(p_0) = 0\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ C = \ln{p_0} $$&lt;/div&gt;
&lt;p&gt;Hence:&lt;/p&gt;
&lt;div class="math"&gt;$$ \phi(p) = R\bar T\ln{(p_0/p)} $$&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="atmospheric science"></category><category term="meteorology"></category><category term="physics"></category></entry><entry><title>Hydrostatic balance in the atmosphere</title><link href="http://0x7df.github.io/hydrostatic-balance-in-the-atmosphere.html" rel="alternate"></link><published>2015-05-02T22:10:00+01:00</published><updated>2015-05-02T22:10:00+01:00</updated><author><name>0x7df</name></author><id>tag:0x7df.github.io,2015-05-02:/hydrostatic-balance-in-the-atmosphere.html</id><summary type="html">&lt;p&gt;Atmospheric pressure at any altitude represents the total weight, per
unit area, of the air column above that altitude. The pressure,
therefore, decreases with altitude as there is less air above pressing
down. To find the rate of decrease of pressure with height, consider a
vertical column of air with …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Atmospheric pressure at any altitude represents the total weight, per
unit area, of the air column above that altitude. The pressure,
therefore, decreases with altitude as there is less air above pressing
down. To find the rate of decrease of pressure with height, consider a
vertical column of air with unit cross-sectional area, having
pressure &lt;span class="math"&gt;\( p\)&lt;/span&gt; at height &lt;span class="math"&gt;\( z
$. At height $ z + dz\)&lt;/span&gt; the pressure
has decreased to some value &lt;span class="math"&gt;\( p-dp\)&lt;/span&gt;, and the
pressure difference &lt;span class="math"&gt;\( dp\)&lt;/span&gt; is equal to the weight
of the slice of the vertical air column having thickness &lt;span class="math"&gt;\( dz\)&lt;/span&gt;
(at height &lt;span class="math"&gt;\( z\)&lt;/span&gt;).
Assuming &lt;span class="math"&gt;\( dz\)&lt;/span&gt; is small enough that the air
density, &lt;span class="math"&gt;\( \rho\)&lt;/span&gt;, and the acceleration due to
gravity, &lt;span class="math"&gt;\( g\)&lt;/span&gt;, can both be considered constant
within the slice:&lt;/p&gt;
&lt;div class="math"&gt;$$ dp = -g \rho dz $$&lt;/div&gt;
&lt;p&gt;Here &lt;span class="math"&gt;\( g\)&lt;/span&gt; is the acceleration of gravity that
transforms the areal mass element &lt;span class="math"&gt;\( \rho dz\)&lt;/span&gt; into
an areal weight element &lt;span class="math"&gt;\( g\rho dz\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;This equation is called the &lt;em&gt;hydrostatic equation&lt;/em&gt;. It is commonly
written as:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial p}{\partial z} = -g \rho $$&lt;/div&gt;
&lt;p&gt;This expresses that the upward vertical pressure-gradient force is
balanced by the downward gravitational force, a situation usually
referred to as &lt;em&gt;hydrostatic equilibrium&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;With increasing altitude, the density of air also decreases (e.g. from
an average of 1.2 kg/m^3^ at the surface to an average of 0.7 kg/m^3^ at
5 km); hence the rate of change of pressure with height decreases with
height. Air temperature also affects density (in a way described by the
equation of state), and therefore the rate of pressure decrease with
altitude.&lt;/p&gt;
&lt;p&gt;Substituting in the equation of state allows us to integrate the
hydrostatic equation to obtain an expression for &lt;span class="math"&gt;\( p(z)\)&lt;/span&gt;.
The equation of state for dry air is:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = \rho R T $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( R = R^{*}/m\)&lt;/span&gt; is the individual gas
constant for dry air, and &lt;span class="math"&gt;\( R^{*}\)&lt;/span&gt; and &lt;span class="math"&gt;\( m
are the universal gas constant and the molecular weight
of dry air, respectively. (The equation of state for moist air can be
obtained by replacing $ T\)&lt;/span&gt; with &lt;span class="math"&gt;\( T_v\)&lt;/span&gt;,
which is the &lt;em&gt;virtual temperature&lt;/em&gt;. It can be shown
that moist air is lighter than dry air of the same temperature and
pressure, because the water vapour is lighter than the dry air it
replaces; so that in cases where only the density of air is important,
dry air of slightly higher temperature may be substituted for moist air.
Virtual temperature is the fictitious temperature to which dry air must
be raised to have the same density as the moist air in question, and of
course it depends on the moisture content as well as the pressure.)&lt;/p&gt;
&lt;p&gt;Making this substitution gives:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial p}{\partial z} = -\frac{g}{RT}p
$$&lt;/div&gt;
&lt;p&gt;and hence:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{dp}{p} = \frac{g}{RT}dz $$&lt;/div&gt;
&lt;p&gt;By integration:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = p_0 \exp \left( -\frac{g}{R} \int_{z_0}^z
\frac{1}{T} dz' \right) $$&lt;/div&gt;
&lt;p&gt;(assuming &lt;span class="math"&gt;\( g\)&lt;/span&gt; is constant with height).&lt;/p&gt;
&lt;p&gt;In the special case where the temperature is constant with height, the
pressure profile is:&lt;/p&gt;
&lt;div class="math"&gt;$$ p = p_0 \exp \left( -\frac{g(z-z_0)}{RT} \right)
$$&lt;/div&gt;
&lt;p&gt;The temperature in the atmosphere varies by a factor of two, whereas the
pressure varies by six orders of magnitude.&lt;/p&gt;
&lt;h2&gt;Model atmospheres&lt;/h2&gt;
&lt;p&gt;The following is question 3.5 from &lt;a href="https://www.elsevier.com/books/a-short-course-in-cloud-physics/yau/978-0-7506-3215-7"&gt;&lt;em&gt;A Short Course in Cloud Physics&lt;/em&gt;,
by Rogers and
Yau&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Two model atmospheres often used in theoretical work are the
homogeneous atmosphere:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\( \rho(z) = \rho_0 $\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;and the exponential atmosphere:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\( \rho(z) = \rho_0 e^{-z/H} $\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;where&lt;/em&gt; &lt;span class="math"&gt;\( \rho_0\)&lt;/span&gt; &lt;em&gt;is the density at the
surface and H is called the scale height of the atmosphere. The top of
the homogeneous atmosphere is defined as the altitude where the
pressure falls to zero. Prove that the height of the top of the
homogeneous atmosphere equals the scale height of the exponential
atmosphere.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;For this problem we need the equation of &lt;a href="en.wikipedia.org/wiki/Hydrostatic_equilibrium"&gt;hydrostatic
balance&lt;/a&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial p}{\partial z} = -\rho(z) g $$&lt;/div&gt;
&lt;p&gt;which describes the equilibrium achieved in a fluid under gravity, where
the upward&lt;a href="en.wikipedia.org/wiki/Pressure-gradient_force"&gt;pressure gradient
force&lt;/a&gt; balances the
opposing force due to gravity.&lt;/p&gt;
&lt;p&gt;First consider the &lt;a href="http://glossary.ametsoc.org/wiki/Homogeneous_atmosphere"&gt;homogeneous
atmosphere&lt;/a&gt;;
using this equation it is very simple to calculate the height at which
the pressure falls to zero because, since the density is constant, the
gradient of pressure with height is also constant:&lt;/p&gt;
&lt;div class="math"&gt;$$ \frac{\partial p}{\partial z} = -\rho_0 g $$&lt;/div&gt;
&lt;p&gt;That is, the pressure falls off linearly:&lt;/p&gt;
&lt;div class="math"&gt;$$ p(z) = \left( -\rho_0 g \right) z + p_0 $$&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\( p_0\)&lt;/span&gt; is the pressure at the surface
(&lt;span class="math"&gt;\( z = 0\)&lt;/span&gt;). From this equation we see that the
pressure falls to zero when:&lt;/p&gt;
&lt;div class="math"&gt;$$ z|_{p=0} = \frac{p_0}{\rho_0 g} $$&lt;/div&gt;
&lt;p&gt;Now consider the &lt;a href="http://en.wikipedia.org/wiki/Barometric_formula"&gt;exponential
atmosphere&lt;/a&gt;; we can
determine &lt;em&gt;H&lt;/em&gt; in the following way. First, we integrate the equation for
hydrostatic balance from some height &lt;span class="math"&gt;\( z = z'\)&lt;/span&gt; up
to &lt;span class="math"&gt;\( z = \infty\)&lt;/span&gt; to obtain the pressure at height
&lt;span class="math"&gt;\($ z'\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;$$ \int_{z'}^{\infty} \frac{\partial p}{\partial z} dz =
-\rho_0 g \int_{z'}^{\infty} e^{-z/H} dz $$&lt;/div&gt;
&lt;p&gt;If we assume that the pressure tends to zero as height tends to
infinity, and we set &lt;span class="math"&gt;\( z' = 0\)&lt;/span&gt;, then:&lt;/p&gt;
&lt;div class="math"&gt;$$ p_0 = \rho_0 g H $$&lt;/div&gt;
&lt;p&gt;Consequently:&lt;/p&gt;
&lt;div class="math"&gt;$$ H = \frac{p_0}{\rho_0 g} $$&lt;/div&gt;
&lt;p&gt;Hence, as long as &lt;span class="math"&gt;\( p_0\)&lt;/span&gt; has the same value in
both the homogeneous and exponential atmospheres, the height of the top
of the homogeneous atmosphere is equal to the scale height of the
exponential atmosphere.&lt;/p&gt;
&lt;div&gt;

[![Pressure (mb) vs. height (m) for two model
atmospheres](https://plot.ly/~0x7df/11.png)](https://plot.ly/~0x7df/11/ "Pressure (mb) vs. height (m) for two model atmospheres")  
&lt;https://plot.ly/embed.js&gt;

&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="exponential atmosphere"></category><category term="fluid dynamics"></category><category term="homogeneous atmosphere"></category><category term="hydrostatic balance"></category><category term="hydrostatic equilibrium"></category><category term="meteorology"></category></entry></feed>