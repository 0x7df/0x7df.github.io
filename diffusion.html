<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Diffusion Equation The time-dependent diffusion equation is: $$ \frac{\partial u}{\partial t} = \nabla \cdot \left( D\left(\mathbf{r}, t\right) \nabla u\left(\mathbf{r}, t\right) \right) +...">
        <meta name="keywords" content="diffusion, physics">
        <link rel="icon" href="http://0x7df.github.io/favicon.ico">

        <title>Diffusion - 0x7df</title>

        <!-- Stylesheets -->
        <link href="http://0x7df.github.io/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="http://0x7df.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="0x7df Full Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="http://0x7df.github.io/"><img class="mr20" src="http://0x7df.github.io/images/0x7df_60x60.png" alt="logo">0x7df</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="http://0x7df.github.io/">Blog Home</a>
                                <a href="http://0x7df.io">Site Home</a>
                                <a href="http://0x7df.github.io/categories.html">Categories</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Diffusion</h1>
                      <p class="header-date">By <a href="http://0x7df.github.io/author/0x7df.html">0x7df</a>, Sun 05 March 2017, in category <a href="http://0x7df.github.io/category/physics.html">Physics</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="http://0x7df.github.io/tag/diffusion.html">diffusion</a>, <a href="http://0x7df.github.io/tag/physics.html">physics</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <h2>Diffusion Equation</h2>
<p>The time-dependent diffusion equation is:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} = \nabla \cdot \left(
D\left(\mathbf{r}, t\right) \nabla u\left(\mathbf{r}, t\right)
\right) + Q\left(\mathbf{r}, t\right)  
 $$</div>
<p>where:</p>
<ul>
<li><span class="math">\( \mathbf{r}\)</span> is position</li>
<li><span class="math">\( t\)</span> is time</li>
<li><span class="math">\( u \left( \mathbf{r}, t \right)\)</span> is the
    unknown, i.e. diffusing quantity</li>
<li><span class="math">\( D \left( \mathbf{r}, t \right)\)</span> is the
    diffusion coefficient</li>
<li><span class="math">\( Q \left( \mathbf{r}, t \right)\)</span> is the
    source density</li>
</ul>
<p>From hereon we will display the quantities <span class="math">\( D\)</span>,
<span class="math">\( Q\)</span> and <span class="math">\( u\)</span> without
their arguments, for simplicity of notation.</p>
<p>To derive the diffusion equation we begin with Fick's law <a href="#fn1">(Fick,
1855)</a>:</p>
<div class="math">$$  
\mathbf{F} = -D \nabla u  
 $$</div>
<p>The vector field <span class="math">\( \mathbf{F}\)</span> is the flux,
which is the rate of transfer per unit area; the integral of the normal
component of <span class="math">\( \mathbf{F}\)</span> over a given surface
is equal to the rate of flow through the surface. The direction of the
flux vector is normal to the surface of constant concentration. Fick's
law says that for a given concentration <span class="math">\( u\)</span> at a
point <span class="math">\( \mathbf{r}\)</span>, the flux is
proportional to the concentration gradient there, and has the opposite
direction.</p>
<p><span class="math">\( Q\)</span> is the source density: the concentration
produced per unit time per unit volume.</p>
<p>The divergence of <span class="math">\( \mathbf{F}\)</span>, i.e. <span class="math">\(
\nabla \cdot \mathbf{F}\)</span>, is the rate of loss of
concentration per unit time from the volume element.</p>
<p>Hence, by conservation:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} =  
- \nabla \cdot \mathbf{F} + Q  
 $$</div>
<p>Hence:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} =  
\nabla \cdot D \nabla u + Q  
 $$</div>
<p>As we saw above, this is the diffusion equation (sometimes known as
Fick's second law).</p>
<p>The equation as written is linear, although it would be non-linear if we
allowed the diffusion coefficient <span class="math">\( D\)</span> to vary
with the unknown <span class="math">\( u\)</span>, as well as with <span class="math">\( x\)</span>
and <span class="math">\( t\)</span>.</p>
<h2>Special Cases</h2>
<p>In the special case that <span class="math">\( D\)</span> is constant in space and time, then
this equation simplifies to:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} = D \nabla^2 u + Q  
 $$</div>
<p>and in steady-state, if <span class="math">\(Q\)</span> is also constant, <span class="math">\( \partial u/\partial t = 0\)</span>,
it reduces to Poisson's equation:</p>
<div class="math">$$  
\nabla^2 u = \frac{Q}{D}
 $$</div>
<p>and further to Laplace's equation if the source term is zero:</p>
<div class="math">$$  
\nabla^2 u = 0  
 $$</div>
<p>Returning now to the full equation, we recall that:</p>
<div class="math">$$
\nabla = \hat i \frac{\partial}{\partial x} + \hat j
\frac{\partial}{\partial y} + \hat k \frac{\partial}{\partial z}
$$</div>
<div class="math">$$
= \hat e_{\rho} \frac{\partial}{\partial \rho} + \hat
e_{\phi} \frac{\partial}{\partial \phi} + \hat e_z
\frac{\partial}{\partial z}
$$</div>
<div class="math">$$
= \hat e_{r} \frac{\partial}{\partial r} + \hat e_{\theta}
\frac{\partial}{\partial \theta} + \hat e_{\phi}
\frac{\partial}{\partial \phi}  
$$</div>
<p>in Cartesian, cylindrical and spherical geometries, respectively.</p>
<p>Consider first spherical geometry:</p>
<div class="math">$$  
\nabla \cdot D \nabla u = $$</div>
<div class="math">$$
\frac{1}{r^2} \frac{\partial}{\partial r} \left( r^2 D
\frac{\partial u}{\partial r} \right) +  
\frac{1}{r \sin \theta} \frac{\partial}{\partial \theta} \left(
\frac{D \sin \theta }{r} \frac{\partial u}{\partial \theta}
\right) +  
\frac{1}{r \sin \theta} \frac{\partial}{\partial \phi} \left(
\frac{D}{r \sin \theta} \frac{\partial u}{\partial \phi}
\right)  
 $$</div>
<p>In cylindrical geometry:</p>
<div class="math">$$  
\nabla \cdot D \nabla u =  
\frac{1}{\rho} \frac{\partial}{\partial \rho} \left( \rho D
\frac{\partial u}{\partial \rho} \right) +  
\frac{1}{\rho} \frac{\partial}{\partial \phi} \left(
\frac{D}{\rho} \frac{\partial u}{\partial \phi} \right) +  
\frac{\partial}{\partial z} \left( D \frac{\partial u}{\partial
z} \right)  
 $$</div>
<p>and in Cartesian geometry:</p>
<div class="math">$$  
\nabla \cdot D \nabla u =  
\frac{\partial}{\partial x}\left( D \frac{\partial u}{\partial
x} \right) +  
\frac{\partial}{\partial y}\left( D \frac{\partial u}{\partial
y} \right) +  
\frac{\partial}{\partial z}\left( D \frac{\partial u}{\partial
z} \right)  
 $$</div>
<p>In one dimension:</p>
<div class="math">$$
\frac{\partial u}{\partial t} = \frac{1}{r^2}
\frac{\partial}{\partial r} \left( r^2 D \frac{\partial
u}{\partial r} \right) + Q   
$$</div>
<div class="math">$$\frac{\partial u}{\partial t} = \frac{1}{\rho}
\frac{\partial}{\partial \rho} \left( \rho D \frac{\partial
u}{\partial \rho} \right) + Q
$$</div>
<div class="math">$$
\frac{\partial u}{\partial t} = \frac{\partial}{\partial x}
\left( D \frac{\partial u}{\partial x} \right) + Q  
 $$</div>
<p>These equations can be generalised:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} = \frac{1}{x^p}
\frac{\partial}{\partial x} \left(x^p D \frac{\partial
u}{\partial x} \right) + Q  
 $$</div>
<p>where:</p>
<ul>
<li><span class="math">\( p = 0\)</span> for plane geometry</li>
<li><span class="math">\( p = 1\)</span> for 1D cylindrical geometry, and</li>
<li><span class="math">\( p = 2\)</span> for 1D spherical geometry.</li>
</ul>
<h2>Heat Flow Equation</h2>
<p>The phenomena of heat conduction and diffusion are basically the same,
and <a href="#fn1">Fick, 1855</a> first put diffusion on a quantitative
basis by adopting the mathematical equation of heat conduction derived
by Fourier <a href="#fn2">(Fourier, 1822)</a>.</p>
<p>The heat flow equation of Fourier is:</p>
<div class="math">$$  
a \frac{\partial \theta}{\partial t} = \frac{\partial}{\partial
x} K \frac{\partial \theta}{\partial x}  
 $$</div>
<p>where <span class="math">\( a\)</span> is the heat capacity of the material
per unit volume and <span class="math">\(K\)</span> is the thermal
conductivity. For constant conductivity this becomes:</p>
<div class="math">$$  
\frac{\partial \theta}{\partial t} = \frac{K}{a}
\frac{\partial^2 \theta}{\partial x^2}  
 $$</div>
<p>where the corresponding equation for diffusion is:</p>
<div class="math">$$  
\frac{\partial u}{\partial t} = D \frac{\partial^2 u}{\partial
x^2}  
 $$</div>
<p>For the two equations to correspond, we equate temperature
<span class="math">\( \theta\)</span> with concentration <span class="math">\( u\)</span>, which clearly implies that <span class="math">\( D = K/a\)</span>.
However, it is also the case that:</p>
<div class="math">$$  
\mathbf{F} = -K \nabla \theta  
 $$</div>
<p>which, when compared with Fick's law for diffusion, implies that
<span class="math">\( D = K\)</span>, and therefore that in diffusion, unlike in heat
conduction, <span class="math">\( a = 1\)</span>. This is because we have
identified <span class="math">\( C\)</span> with <span class="math">\( \theta\)</span>,
whereas in heat conduction, the diffusing 'substance'
is actually heat, not temperature. The factor <span class="math">\( a\)</span> 
is needed to convert temperature to the amount of heat per unit
volume, whereas in diffusion, the concentration is already by definition
the amount of substance per unit volume, so <span class="math">\( a = 1\)</span>.</p>
<hr>
<ol>
<li><a name="fn1" href="http://www.tandfonline.com/doi/abs/10.1080/14786445508641925">
    Fick, A, 1855. On liquid diffusion. The London,
    dinburgh, and Dublin Philosophical Magazine and Journal of Science,
    X, 30-39.</a></li>
<li><a name="fn2" href="https://books.google.co.uk/books?id=No8IAAAAMAAJ">
    Fourier, JBJ, 1822. Théorie Analytique de la chaleur. F.
    Didot, Paris.</a></li>
</ol>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="http://0x7df.github.io/archives.html">Archives</a></li>
                            <li><a href="http://0x7df.github.io/tags.html">Tags</a></li>
                            <li><a href="http://0x7df.github.io/authors.html">Authors</a></li>
                            <li><a href="http://0x7df.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://twitter.com/@0x7df" target="_blank">Twitter</a></li>
                            <li><a href="https://github.com/0x7df" target="_blank">GitHub</a></li>
                            <li><a href="https://www.facebook.com/0x7df" target="_blank">Facebook</a></li>
                            <li><a href="https://stackoverflow.com/users/4802778" target="_blank">StackOverflow</a></li>
                            <li><a href="http://www.freecodecamp.com/0x7df" target="_blank">FreeCodeCamp</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
                            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
                            <li><a href="https://github.com/barrysteyn/pelican_plugin-render_math" target="_blank">Maths plugin</a></li>
                            <li><a href="https://github.com/molivier/nest" target="_blank">Nest theme</a></li>
                            <li><a href="" target="_blank"></a></li>
                            <li><a href="" target="_blank"></a></li>
                            <li><a href="" target="_blank"></a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; 0x7df 2015</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>